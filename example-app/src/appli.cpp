/*************************************************************************
	Appli  -  Sphero control applicaiton -- main
							 -------------------
	started                : 08/05/2015
*************************************************************************/

#include <iostream>
#include <string>

#include <readline/readline.h>
#include <readline/history.h>

#include "CommandHandler.h"

using namespace std;

static void helloScreen()
{
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#i~^^^^^^^_e&@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@$~^^^^^^^^^^^^^^^;&@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@e^^^^.~--_____--~.^^^.#@@@@@@@@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@@@@@@@$^^^.--__:;;;=;+;:__-~.^^~@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@_^^.--_+;+;;+;i;i;+;;;__~.^^!@@@@@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@@@@@^^^--_=;+;;+oe!!!!oi;+;;=__~^^_@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@&^^.-_+;+;i?!e******ee!!=+;;+_-.^~@@@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@@&^^~-_;+;o!e*i-```````-o*e?=+;;_-.^.@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@^^~-:=;+?e*-`````````````:*e!;+;:-.^-@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@.^.-;;;*!*_````^^^`^^^^^``^^+*!=;;:-.^=@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@;^.-:;i*e*^^^^^^^^^^^^^^^^^^^^.*!i+;:-^^#@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@#^^-_i;oeo^^^^^^^^^^^^^^^^^^^^^^^*e=;i_~^^@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@^^~-;;oe*`              `^^^^^^^^^*!=;;_.^o@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@%^^-;;;!*^^iiiiiiiiiiiiiii: `^^^^^^^*?;i:-^^@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@.^~-;i!*~^^^-iiiiiiiiiiiiiii= ^^^^^^:e*;;_.^*@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@&^^-;;+ei^^^^^^iiiiiii;_:+iiiii^^^^^^^*!;i:-^^@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@+^~-;i!*^^^^^^^iiii;^^^^^^^^iiii.^^^^^~e*;;_.^&@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@^^-_;;!o^^^^^^;iii^^^^^^^^^^^_iii`^^^^^*!+i_~^=@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@^^-;i*e~^^^^^`iii^^^^^^^^^^^^^-iii^^^^^;e+;:-^^@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@%^.-;;!*^^^^^^iii.^^^^^^^^^^^^^^;ii-^^^^^**;+_^^@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@=^~-ii!*^^^^^^ii+^^^^^^  ^^^^^^^^iii^^^^^*?;;_.^@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@-^~_;;!i^^^^^:ii^^^^^^.ii-^^^^ ^^;ii^^^^^*!;;_.^$@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@.^-_++e;^^^^^iii^^^^^^iiii^^^ii.^.ii-^^^^o!+;_.^!@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@^^-_;+e:^^^^^iii^^^^^-iiii:^-iii^^ii;^^^^=!;;_.^*@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@^^-_;+e:.....ii+.....:iiii+.;iii..ii+....i!=i_.^*@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@^^-_;;e+.....ii=....._iiii;.:iii..ii+....o!;;_.^e@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@~^~_;;!i.....iii......iiii~..ii+.^ii:....*!ii_.^%@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@+^~-=+!*.....=ii^.....+ii=....~..-ii.....*?;;_.^&@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@!^.-;;!*.....-ii-......~-........iii.....*e=;_^^@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@^^-+ioe_.....iii^...............ii+....=e+;:-^^@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@^^-_;;!*....._ii=^............ iii.....*!=;_.^:@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@-^.-+i!*~.....iii+^.......... iii_....:e*;+_.^$@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@O^^-:;+e*......iiii ^......`-iii+.....*!=;:-^^@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@^^~_+iee:......iiiii-   `:iiii+.....=eo;=_.^;@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@*^^-:;;!*~......+iiiiiiiiiiii_....._*?i;:-^^@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@^^~-;i+!*.......~=iiiiiiii:......~*!+;=_.^_@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@!^^-_;;*e*~........~_:_-........-*!=i;_~^^@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@.^^-:o;oe*_...................;*!i;;:-^^e@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@^^.-:;i=!*o~~~..~...~..~...~oe!+;+:-.^~@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@$^^._:;;i?e*i~~~~~~~~~~~~-o*e!++;:-.^^@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@!^^.-_+;;*?e**i:~~~~-:i**e?++;=_-.^^@@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@@@e^^.-_;+;;o!!ee*****ee!e++;i;_~.^^&@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@?^^^~__;;;;i+**!!e*i+;+;i;_-.^^^@@@@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@@@@@&^^^.-__;;+;i;i;+;;+;i:__~.^^-@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@;^^^.~-__:;;=;;;::__-~.^^^?@@@@@@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@@@@@@@@&~^^^^.~---___--~..^^^^=@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@&:^^^^^^^^^^^^^^^^^*@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
//	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@@@O+^^^^^^^^^^~o@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Welcome @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ to @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@ Sphero-linux API test application @@@@@@@@@@@@@@@@@" << endl;
	cout << "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@" << endl;
	cout << endl;
}

int main(void)
{
	cout << "\033]0;Sphero-cmd\007";
	cout.flush();

	char *buf;
	rl_bind_key('\t',rl_abort);//disable auto-complete

	string command("");
	helloScreen();
	showHelp();

	while((buf = readline("\nSphero >> ")) != NULL)
	{

		if (buf[0]!=0)
			add_history(buf);

		command = string(buf);
		if(handleCommand(command) == 0)
			return 0;
	}


	return 0;
}
